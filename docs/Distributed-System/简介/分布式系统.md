# 分布式系统

：将一个软件系统的各个组件分别部署在多台计算机上。
- 小型的软件系统通常只部署在一台计算机上，属于集中式系统。而大型的软件系统通常部署成分布式系统，从而扩展出更多性能。
- 优点：
  - 便于横向扩展系统节点，提高系统容量、性能，比如处理高并发流量。
  - 可以为一个软件应用运行多个实例，提高服务可用性。
  - 可以为一个数据存储多个副本，提高数据安全性。
- 缺点：
  - 各个节点之间需要保证一致性。
  - 系统规模变大、结构变复杂，维护麻烦。
  - 比集中式系统多用了一些技术和组件，比如负载均衡、消息队列、分布式锁、分布式数据库、分布式文件系统。

## 一致性算法

分布式系统中常见的一致性算法：
- Paxos
- Zab（Zookeeper Atomic Broadcast）
- Raft

## ZooKeeper

：一个维护分布式系统的一致性的软件。
- 原本是Hadoop的子项目，现在已成为一个独立的顶级项目。
  - 取名为ZooKeeper是因为Yahoo公司的Pig等项目都是以动物命名，ZooKeeper可以协调它们。
- ZooKeeper常用作生产者和消费者的注册中心。
  - 生产者将自己提供的服务在ZooKeeper上注册，消费者要调用服务时就去ZooKeeper查找该服务。
- ZooKeeper集群中的各个server并不采用主备模式（master/slave），而是分为leader、follower、observer三种角色（借鉴Paxos算法的思想）。
  - leader：负责处理client的读请求和写请求，更新系统的状态并推送给follower、observer。
leader由follower选举产生。
  - follower：负责处理client的读请求，参与leader选举。
  - observer：负责处理client的读请求，扩展系统的读取速度。
- ZooKeeper集群采用Zab算法实现一致性，其原则是：如果多数server写入数据成功，则数据为真。
  - 使用3个server就可以组成一个ZooKeeper集群。
  - server数为3时，最多允许1个server挂掉；server数为4时，也是最多允许1个server挂掉。因此server数最好为奇数，为偶数时可靠性并不会提升。

## Etcd

：一个分布式的键值对数据库。
- 由CoreOS团队于2013年开源，基于Go语言开发。
- 采用Raft算法实现分布式系统的一致性。
