# 其它功能

## 管理用户

```sql
select * from mysql.user;   -- 显示所有用户的信息

create user 'root'@'127.0.0.1';              -- 创建用户root，只允许从该IP地址登录，且不需要输入密码
create user 'root'@'%' identified by 'aaa';  -- 创建用户，允许从任何IP地址登录，密码是aaa

set password for 'root'@'localhost' = password('******');             -- 设置密码（用password()函数会加密）
update mysql.user set password=password('******') where user='root';  -- 如果用户有多个登录地址，还需要指定：and host='localhost';

drop user 'root'@'localhost';   -- 删除用户
```
- 数据库`mysql`存储了MySQL服务器的配置信息，其中的数据表`user`存储了所有MySQL用户的信息。
- 从MySQL5.7开始，mysql.user表的 password 字段改名为 authentication_string 字段，因此要用以下语句修改密码：
  ```sql
  update mysql.user set authentication_string=password('******') where user='root';
  ```

### 管理用户的权限

```sql
show grants;                          -- 查看当前用户的权限
show grants for 'root'@'localhost';   -- 查看指定用户的权限

grant select,insert,update,delete on db1.* to 'root'@'localhost'; -- 授予用户对于数据库db1中所有数据表的查询、修改、插入、删除权限
grant all privileges on db1 to 'root'@'localhost';                -- 授予用户对于数据库db1的全部权限
grant all on *.* to 'root'@'localhost';                           -- 授予用户对于所有数据库的全部权限

FLUSH PRIVILEGES;   -- 刷新权限表（否则要等到MySQL服务器重启时才会生效）

revoke all on *.* from 'root'@'localhost';  -- 将 grant...to 改为 revoke...from ，就是撤销权限
```

### 免密模式

如果忘记了密码，可以停止mysqld，然后用以下命令启动mysqld，在免密模式下修改密码。最后再按正常的方式启动mysqld。
```sh
mysqld --skip-grant-tables --skip-networking --user=mysql
        --skip-grant-tables  # 不开启身份认证（此时不能创建用户、不能分配权限）
        --skip-networking    # 不开启网络功能
        --user=mysql         # 以mysql用户启动（mysqld默认不允许以root用户启动）
```

## mysqladmin

：一个能够管理MySQL服务器的工具，使用时不需要进入MySQL客户端的终端。

```sh
mysqladmin [OPTIONS] [command]...   # 连接到MySQL服务器，执行某种操作
          -h <host>         # 输入主机名等信息，连接到MySQL服务器
          -P <port>
          -u <user>
          -p
          --password=****** 

          password ******   # 修改该用户的密码
          create <db>       # 创建一个datebase
          drop <db>         # 删除一个datebase
          processlist       # 显示MySQL服务器上所有线程的状态
          kill <id>...      # 终止一个线程
          status            # 查看MySQL服务器的状态
          shutdown          # 关闭MySQL服务器

          -c 10 -i 1        # 重复执行10次操作，每次间隔1s
```
