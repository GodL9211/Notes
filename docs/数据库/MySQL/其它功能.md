# 其它功能

保存在MySQL的 datadir 目录下

## binlog

：用于记录MySQL执行的所有写操作，以事务为单位。
- 常用于拷贝数据、备份数据。
- MySQL可能在 datadir 目录下保存多个binlog文件，每个文件中记录多个事务，每个事务的起始地址称为position。
- 每个binlog文件默认最小为 4096 Bytes、最大为 1 GB。但是一个事务总是会整个写入一个binlog文件中，因此binlog文件可能超过最大大小。

binlog有三种格式：
- 
- 
- 

### 相关配置

```conf
[mysqld]
log-bin=mysql-bin    # 启用binlog，并设置binlog文件的前缀名
sync_binlog=1           # 每执行几次事务就保存一次binlog（默认值为0，由文件系统自动刷新缓存）
expire_logs_days=7      # binlog的过期天数（默认为0，过期后会被自动删除）
binlog_format = mixed


```

### 相关命令

- 显示binlog的配置：
    ```
    mysql> show variables like '%log_bin%';
    +---------------------------------+--------------------------------+
    | Variable_name                   | Value                          |
    +---------------------------------+--------------------------------+
    | log_bin                         | ON                             |
    | log_bin_basename                | /var/lib/mysql/mysql-bin       |
    | log_bin_index                   | /var/lib/mysql/mysql-bin.index |
    | log_bin_trust_function_creators | OFF                            |
    | log_bin_use_v1_row_events       | OFF                            |
    | sql_log_bin                     | ON                             |
    +---------------------------------+--------------------------------+
    ```

- 显示已有的所有binlog文件：
    ```
    mysql> show binary logs;
    +------------------+-----------+
    | Log_name         | File_size |
    +------------------+-----------+
    | mysql-bin.000001 |       177 |
    | mysql-bin.000002 |   2922996 |
    | mysql-bin.000003 |       746 |
    +------------------+-----------+
    ```

- 其它命令：
    ```
    show master status\G;                       # 显示master的状态（只有binlog状态）
    show binlog events in 'mysql-bin.000001';   # 显示一个binlog的内容
    show binlog events in 'mysql-bin.000001' FROM 0 limit 2;    # 显示从pos=0开始的最多2个事务

    reset master;                               # 删除所有binlog，重新开始记录
    purge master logs to 'mysql-bin.000003';    # 删除指定的binlog
    ```

- 在shell中，可以用官方提供的mysqlbinlog命令解析binlog的内容。如下：
    ```shell
    mysqlbinlog mysql-bin.000001
    ```


