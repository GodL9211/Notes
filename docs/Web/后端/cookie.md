# cookie

虽然 HTTP 通信是无状态的，但可以通过 cookie 或 session 保存 HTTP 通信的某些信息。

## cookie

- 工作流程：
  1. Web 服务器将各个客户端的某些信息（比如用户名、凭证）保存在客户端的 cookie 文件中。
  2. 当客户端下一次发出 HTTP 请求时，可以在请求报文的 headers 中填入 cookie 数据，从而告知上一次 HTTP 通信的信息。
     - Web 浏览器访问某个网站时会自动使用、且仅使用该网站的 cookie ，将它填入请求报文的 headers 中。
- cookie 保存在客户端上，可能被泄露、篡改、盗用，是不安全的。因此服务器应该采取以下措施：
  - 如果数据不重要，可以直接存放到 cookie 中。比如客户端上一次 HTTP 通信的状态。
  - 如果数据是需要保密的，则加密后再存放到 cookie 中。
  - 如果数据是客户端的某种凭证，则要防止篡改、伪造。还要设置过期时间，过期之后服务器就不认。

## session

- 工作流程：
  1. Web 服务器将每个客户端的信息保存在服务器上，比如数据库、缓存中。只将 session id 发送给客户端，用于分辨客户端的身份。
  2. 客户端每次发出 HTTP 请求时，可以将 session id 放在 HTTP Header、body 或 URL 中，传给服务器。
  3. 服务器根据 session id 找到对应的 session ，载入该客户端的信息。
- 优点：
  - session 存储在服务器上，因此不怕泄露，可以包含敏感信息。
  - session 可以要设置过期时间，过期之后就删除。如果客户端再发送该 session id ，服务器不会认可。
- 缺点：
  - 将 session id 存储在客户端的 cookie 中，可能被 CSRF 攻击。
