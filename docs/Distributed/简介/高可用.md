# 可用性

- 服务器能够不间断地提供服务的时间越长，就称为“可用性”越高。
- 采用负载均衡、健康检查等方式可以实现服务的“高可用性”（High Availability）。

## 负载均衡

：（Load Balance），将业务服务器部署多个实例，并提供一个代理服务器所有用户访问，该服务器会将用户的访问请求按某种算法均衡地转发给各个业务服务器处理。
- 只部署一份业务服务器时，如果它发生故障，就会导致整个服务不可用。该问题称为“单点故障”。
- 采用负载均衡可以避免发生单点故障，并分散各个节点的访问流量压力。

相关工具：
- LVS（Linux Virtual Server）
  - ：Linux 的一个内核模块，可以通过转发 TCP/UDP 报文，实现第四层的负载均衡。
  - LVS 的代理性能最好，但是使用时最麻烦。
- F5 ：一种通过硬件实现负载均衡的服务器，基于 BIG-IP 协议。
- HAProxy
  - ：一个代理程序，可以实现第四层的 TCP 代理、第七层的 HTTP 代理。
- Nginx
  - 一个 Web 前端服务器，可以实现第四层的 TCP 代理、第七层的 HTTP 代理。

## 健康检查

：（Health Check），通过软件检查集群中各个服务器的状态，自动发现故障的服务器。
- 发现故障节点之后，需要及时将它下线，或修复，或重新部署。

相关工具：
- keepalived ：一个软件，可以对集群的各个服务器进行健康检查、自动去除故障的服务器。
  - 在集群的每个服务器上部署一份，相互之间通过 VRRP（Virtual Router Redundancy Protocol ，虚拟路由冗余协议）通信，实现路由的高可用。
  - 工作在第三层时，是基于 ICMP 协议检查服务器是否在线。
  - 工作在第四层时，是基于 TCP 协议检查服务器的端口是否开通。
  - 工作在第七层时，是基于 HTTP 协议检查服务器是否正常工作。
