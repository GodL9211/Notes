# 数据库

- Redis服务器中，默认创建了 16 个数据库，从 0 开始编号。
  - 客户端连接后默认使用 0 号数据库。
- Redis的数据库以键值对的形式存储数据，类似于Python中的字典。

## 管理数据库

命令：
```
select n      # 切换到第n号数据库
move <key> n  # 将当前数据库的一个key移动到第n号数据库
dbsize        # 返回当前数据库的key总数

flushdb       # 删除当前数据库的所有key
flushall      # 删除所有数据库的所有key
```

## 管理key

命令：
```
keys <pattern>           # 显示匹配pattern的所有key（例如keys *）
del <key>...             # 删除key
exists <key>...          # 判断key是否存在

rename <key> <newkey>    # 重命名key（如果newkey已存在，则覆盖它）
renamenx <key> <newkey>  # 重命名key（如果newkey已存在，则不执行操作）

type <key>               # 返回key的value的数据类型
dump <key>               # 返回key的序列化后的value
```

大部分命令执行之后会返回生效的key数，返回值为 0 则表示执行失败，返回值为 nil 则表示不存在该key。如下：
```
127.0.0.1:6379> exists key1 key2
(integer) 2
127.0.0.1:6379> get key1
"hello"
127.0.0.1:6379> del key1
(integer) 1
127.0.0.1:6379> get key1
(nil)
```

## key的过期时间

可以给key设置过期时间（time to live），过期之后会被Redis自动删除（不一定会立即删除）。
- 如果key的ttl为-1，则表示不会过期。

```
expire <key> <seconds>          # 设置key在几秒后过期
pexpire <key> <milliseconds>    # 设置key在几毫秒后过期

expireat <key> <timestamp>                  # 设置key在某个时间戳（单位为秒）之后过期
pexpireat <key> <milliseconds-timestamp>    # 设置key在某个时间戳（单位为毫秒）之后过期

ttl <key>        # 返回key剩下的过期时间（单位为秒）
pttl <key>       # 返回key剩下的过期时间（单位为毫秒）

persist <key>    # 取消key的过期时间
```
