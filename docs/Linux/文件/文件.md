# 文件

Linux 系统中，一切对象都是文件。比如数据、目录、设备、套接字都以文件的形式保存，供用户读写。
- 目录实际上是目录类型的文件，本身占 4 kB 的磁盘空间，与目录下的各个文件构成逻辑上的层级关系。
- 平时提到的“文件”概念容易混淆，有时提到的“文件”包括目录文件，有时则不包括。

## 文件类型

文件类型|英文名|符号
-|-|-
普通文件   | regular file           | -
目录文件   | directory              | d
软链接文件  | symbolic link          | l
套接字文件  | socket                 | s
块设备文件  | block special file     | b
字符设备文件 | character special file | c

## 文件的命名规则

- 区分大小写，不能包含正斜杆 / 。
- 名字以 . 开头的文件是隐藏文件。
- 每个目录下都有 . 和 .. 两个隐藏文件，指向当前目录和上一级目录。

## 链接文件

Linux 系统中有两种链接文件（link file）：
- 硬链接（hard link）
  - 与目标文件的内容、大小、文件类型相同，指向目标文件所指的 inode 。
  - 如果文件 B 是文件 A 的硬链接，则删除文件 A 不会影响到文件 B ，但是修改文件 A 会同时修改文件 B 。
  - 不能跨文件系统创建硬链接。
- 符号链接（symbolic link）
  - 又称为软链接，是一个 2 Bytes 大小的文件，存储着目标文件的路径。
  - 如果文件 B 是文件 A 的软链接，则删除文件 A 后文件 B 就指向一个无效的路径。

## 文件描述符

Linux 系统中，进程每打开一个文件时会分配一个文件描述符，作为该文件的唯一标识。
- 文件描述符是从 0 开始的非负整数，且优先分配当前可用的最小值。
- 每个进程使用的文件描述符都会记录在 `/proc/<PID>/fd/` 目录下。如下：
  ```
  [root@Centos ~]# file /proc/self/fd/*
  /proc/self/fd/0:   symbolic link to `/dev/pts/2'
  /proc/self/fd/1:   symbolic link to `/dev/pts/2'
  /proc/self/fd/2:   symbolic link to `/dev/pts/2'
  ```
- 进程刚启动时，总是会先打开 stdin、stdout、stderr 三个文件：
  - /dev/stdin ：标准输入（默认从终端读取输入），文件描述符为 0 。
  - /dev/stdout ：标准输出（默认显示到终端），文件描述符为 1 。
  - /dev/stderr ：标准错误（默认显示到终端），文件描述符为 2 。
  因此，之后打开的文件是使用从 3 开始的文件描述符。
