# 目录

- 物理上，Linux 系统的文件可能储存在磁盘、内存等设备中；逻辑上，每个文件存储在目录中，而所有目录按上下层级、树形结构组成了目录树。
- 目录树的根部称为根目录，即最上层目录。
- 每个文件都有自己的存储路径，用于在目录树中定位它。

## 目录符号

Linux 系统提供了一些指向特定目录的符号：

  符号  | 指向的目录
  -     | -
  .     | 当前目录
  ..    | 上一级目录
  -     | 上一次所在的目录
  ~     | 当前用户的家目录
  ~leo  | 指定用户的家目录

## 相关命令

### pwd

```sh
$ pwd             # 显示当前的工作目录（print working directory）
```

### cd

```sh
$ cd [dir]        # 切换到指定目录（change directory），不指定 path 则相当于 cd ~
     -            # 切换到上一次所在的目录
     ..           # 切换到上一级目录
```

### mkdir

```sh
$ mkdir <dir>...  # 创建一个目录（如果该目录已存在，则报错）
        -p        # 当该目录已存在时，不报错（可用于创建多层目录）
```
- 例：
  ```sh
  mkdir dir1 dir2   # 创建多个同级目录
  mkdir -m 711 dir1 # 创建目录并分配权限，而不是默认权限
  ```

### rmdir

```sh
$ rmdir <dir>...      # 删除一个目录（如果该目录不为空，则报错）
```

### basename

```sh
$ basename <path>     # 获得一个路径的最后一段的名字
           [suffix]   # 去掉后缀
```
- 例：
  ```sh
  basename /root/1.py .py    # 显示为：1
  ```

## FHS

为了规范不同用户使用目录的习惯，Linux 基金会制定了文件系统层次化标准（Filesystem Hierarchy Standard ，FHS），它规定了根目录下应该有哪些目录、分别用于什么用途。

关于系统：
- `/boot` ：存储系统开机时需要的文件，比如 grub、内核文件。
- `/bin` ：存储系统的一些可执行文件。
- `/sbin` ：存储系统的一些重要的管理程序，只有 root 用户能使用。
- `/lib` ：存储系统的一些函数库、目标文件，供/bin、/sbin 目录下的程序调用。

软件使用的目录：
- `/usr` ：存储大部分软件的源文件，全称为 Unix Software Resource 。
  - `/usr/bin` ：存储软件的可执行文件。
  - `/usr/include` ：存储 C/C++ 语言的头文件。
  - `/usr/lib` ：存储软件的函数库、目标文件。
  - `/usr/share` ：存储共享文件。
  - `/usr/src` ：存储源代码。
  - `/usr/local` ：存储用户自己安装的软件（是编译后的软件包，不是源代码），相当于 Windows 的 Programs Files 文件夹。
- `/opt` ：安装一些第三方软件。
- `/etc` ：存储一些配置文件。
- `/run` ：存储某些软件运行时产生的临时文件，比如：sshd.pid、docker.sock 。采用 tmpfs 文件系统。
- `/srv` ：存储一些网络服务的数据文件。比如 WWW 服务会使用/srv/www 目录。
- `/var` ：存储一些经常变化的文件。
  - `/var/cache` ：供程序暂时存储一些文件。
  - `/var/log` ：存储各种日志文件。
  - `/var/run/` ：是指向 /run 的符号链接。

用户使用的目录：
- `/root` ：超级用户的主目录。
- `/home` ：普通用户的主目录，该目录下一般有与用户同名的文件夹。
- `/tmp` ：用于临时存储文件。所有用户都可以在这里读、写、创建文件，但非 root 用户只能删除自己的文件。并且，系统会自动清理 /tmp 目录，比如删除超过 10 天没有被访问的文件。

关于设备：
- `/dev` ：存储设备文件、socket 文件。
  - `/dev/null` ：一个特殊的字符设备文件，任何写入的数据都会被丢弃，不能读取到任何值。常用作垃圾箱。
  - `/dev/zero` ：一个特殊的字符设备文件，任何写入的数据都会被丢弃，可以读取到无穷的 Null 值。常用于初始化文件。
- `/media` ：用于挂载媒体设备，比如软盘、光盘（/media/cdrom）。
- `/mnt` ：用于暂时挂载设备、文件系统，比如光驱。
- `/proc` ：一个存储在 RAM 中的虚拟目录，包含一些关于系统信息的文件，它们不占磁盘空间。
- `/sys` ：一个存储在 RAM 中的虚拟目录，与 /proc 类似。

### /proc

：一个存储在 RAM 中的虚拟目录，包含一些由内核生成的文件（大小为 0、只读）。
- 通过这些文件可以与系统内核交互。
- 其中的某些文件采用 ASCII 码，可以用 cat 直接查看其内容。

/proc 目录下的常用文件：
```sh
/proc/
├── <PID>/          # 一个虚拟目录，记录一个正在运行的进程的相关信息
│   ├── exe         # 一个符号链接，指向启动该进程的可执行文件
│   ├── comm        # 记录启动该进程的命令名
│   ├── cmdline     # 记录该进程的启动命令
│   ├── cwd         # 一个符号链接，指向该进程的工作目录
│   ├── environ     # 记录该进程的环境变量
│   ├── fd/         # 一个目录，包含一些符号链接（名字为文件描述符），指向该进程打开的文件
│   ├── root        # 一个符号链接，指向该进程的根目录
│   ├── stat        # 记录该进程的当前状态，是一系列数字，可读性差，会被 ps 命令读取
│   ├── status      # 记录该进程的当前状态，可读性好
│   ├── status      # 记录该进程的详细状态
│   └── task/       # 一个目录，包含该进程创建的所有线程的虚拟目录
│       └── <TID>/  # 一个虚拟目录，记录一个正在运行的线程的相关信息
│           ├── cmdline
│           ├── comm
│           ├── exe
│           └── status
├── cpuinfo         # 记录 CPU 的信息
├── meminfo         # 记录内存的信息
├── devices         # 记录系统的所有设备（包括字符设备、块设备）
├── version         # 记录系统内核的版本
├── swaps           # 记录已启用的所有 swap 分区的信息
└── sys/            # 一个与内核相关的目录
```

- 例：
  ```sh
  [root@CentOS ~]# file /proc/1/exe
  /proc/1/exe: symbolic link to '/usr/lib/systemd/systemd'
  [root@CentOS ~]# cat /proc/1/comm
  systemd
  [root@CentOS ~]# cat /proc/1/cmdline    # 显示启动命令时会去掉空格
  /usr/lib/systemd/systemd--switched-root--system--deserialize22
  ```

- `/proc/self` 目录是一个特殊的符号链接，指向当前查询该目录的进程的 `/proc/<PID>` 目录。如下：
  ```sh
  [root@CentOS ~]# ls -lh /proc/self
  lrwxrwxrwx. 1 root root 0 Nov 12 06:10 /proc/self -> 15030              # 每次执行 ls 命令都是创建一个子进程，因此查询到的 PID 会变化
  [root@CentOS ~]# ls -lh /proc/self
  lrwxrwxrwx. 1 root root 0 Nov 12 06:10 /proc/self -> 15031
  [root@CentOS ~]# ls -lh /proc/self
  lrwxrwxrwx. 1 root root 0 Nov 12 06:10 /proc/self -> 15032
  [root@CentOS ~]# cat /proc/self/cmdline
  cat/proc/self/cmdline
  ```
