# Batch

：批处理。
- 它是微软的磁盘操作系统（Mircro Software Disk Operating System ，MS-DOS）自带的一种脚本语言，用 cmd.exe 解释执行。

## 语法特点

- 在行首用 :: 声明单行注释。
- 命令的一般格式为：
    ```batch
    命令名 [选项] [参数]
    ```
  - 命令名和选项不区分大小写。
  - 选项以 / 开头，比如：`dir /?` 。
  - 如果参数中包含空格，需要用双引号作为定界符包住。比如：`dir "C:/Program Files"`
  - 如果参数中包含双引号，需要写作两个双引号进行转义。比如：`echo "Hello ""World"" "`
  - 参数中可以使用通配符，`*` 表示匹配任意个字符，`?` 表示匹配一个字符或空格。

## 常用命令

关于文件：
```batch
dir                     :: 显示当前目录下的所有文件
dir D:\1\               :: 显示指定目录下的所有文件

copy D:\1\* D:\         :: 拷贝文件（目标目录必须存在）
move D:\1\* D:\         :: 移动文件（目标目录必须存在）
rename 1 2              :: 修改文件名或目录名
del D:\1\*              :: 删除文件（不能删除目录）
```

关于文本：
```batch
echo hello              :: 显示一个字符串
echo Hello > null       :: 重定向 stdout
echo Hello >>f1 2>&1
type 1.py               :: 显示文件的内容
```

关于目录：
```batch
D:                      :: 切换盘符
cd 1                    :: 切换到当前盘符下的其它目录
cd \                    :: 切换到当前盘符的根目录
cd                      :: 显示当前路径

mkdir D:\1\             :: 创建一个目录
rmdir D:\1\             :: 删除一个目录（必须是空目录）
    /s                  :: 如果是非空目录的话也删除
    /q                  :: 安静模式，删除时不需要确认
```

关于终端：
```batch
cls                     :: 清空终端
pause                   :: 阻塞终端，直到用户按下任意按键

help                    :: 显示帮助信息
```

关于进程：
```batch
tasklist                :: 显示当前的所有进程
taskkill /pid 6666 /f   :: 杀死一个进程，其 pid 为 6666 ，f 代表 force 强制杀死
```

定义变量：
```batch
set x=1
echo %x%
```

## 相关概念

Windows 系统的相关概念：
- 钩子（Hook）：用于监听某个进程或窗口的消息。
  - 在 Windows 上，一般进程、窗口的消息都会经过钩子平台中转，因此可以被监听或拦截。
- 句柄（Handler）：对象的唯一标识符。在 32 位系统中，是一个 32 位的无符号整型。
  - 比如窗口的句柄、钩子的句柄。
- PowerShell ：微软于 2006 年推出的新一代脚本语言、shell 程序，基于 .NET Framework 运行，能实现强大、丰富的功能。
